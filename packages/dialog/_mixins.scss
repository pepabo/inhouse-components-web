@use "sass:map";
@use "@pepabo-inhouse/adapter/functions" as adapter;
@use "./variables";

// Dialog Modal Styles
@mixin modal-style($options: variables.$default-options) {
  position: fixed;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  z-index: adapter.get-major-stack-z-index(map.get(variables.$z-index-map, modal));
  display: flex;
  align-items: center;
  justify-content: center;

  ._overlay {
    position: absolute;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
    background-color: adapter.get-scrim-background-color();
  }

  ._container {
    position: relative;
    z-index: map.get(variables.$z-index-map, dialog);
    margin: adapter.get-spacing-size(m);
    outline: none;
  }
}

// Dialog Content Styles
@mixin dialog-style($options: variables.$default-options) {
  $options: map.merge(variables.$default-options, $options);
  $size: map.get($options, size);
  $size-config: map.get(variables.$size-map, $size);

  width: map.get($size-config, width);
  max-width: map.get($size-config, max-width);
  max-height: 90vh;
  padding: adapter.get-spacing-size(l) 0;
  border-radius: adapter.get-radius-size(m);
  background: adapter.get-surface-color(light, primary);
  display: grid;
  grid-template-rows: auto 1fr auto;
  grid-template-columns: 1fr min(adapter.get-content-size(s), calc(100% - adapter.get-spacing-size(l) * 2)) 1fr;
  gap: adapter.get-spacing-size(l) adapter.get-spacing-size(l);
  animation: dialog-in 200ms ease-out;

  @include adapter.elevation(6);

  > * {
    grid-column: 2;
  }

  ._header {
    // header styles
  }

  ._title {
    @include adapter.text(l);
    margin: 0;
  }

  ._content {
    overflow-y: auto;
  }

  ._footer {
    display: flex;
    justify-content: center;
    gap: adapter.get-spacing-size(s);
  }

  // Size variants
  @each $variant-size in "s", "m", "l" {
    &.-size-#{$variant-size} {
      @include -size-style($variant-size);
    }
  }
}

@mixin -size-style($size) {
  $size-config: map.get(variables.$size-map, $size);
  width: map.get($size-config, width);
  max-width: map.get($size-config, max-width);
}

// Keyframes for dialog animation
@mixin keyframes {
  @keyframes dialog-in {
    from {
      transform: scale(0.98);
      opacity: 0%;
    }
    to {
      transform: scale(1);
      opacity: 100%;
    }
  }
}

// Export mixin for CSS classes
@mixin export {
  @include keyframes;

  .in-dialog-modal {
    @include modal-style;
  }

  .in-dialog {
    @include dialog-style;
  }
}
